# 3.1 ASP安全

## 3.1.1 ASP环境搭建组合

[在自己的 PC 上运行 ASP | 菜鸟教程 (runoob.com)](https://www.runoob.com/asp/asp-install.html)

## 3.1.2 ASP-数据库下载&植入

## 3.1.3 IIS-短文件&解析&写权限

## 3.1.4 演示案例

### 3.1.4.1 数据库-MDB默认下载

- 搭建的时候，我们如果没有改变存储数据的位置，这个时候我们可以默认下载

![屏幕截图 2024 07 22 152548](https://img.picgo.net/2024/07/22/-2024-07-22-15254859831225211373ac.png)

- 就可以顺利下载到网站的数据库文件啦

![屏幕截图 2024 07 22 152625](https://img.picgo.net/2024/07/22/-2024-07-22-152625d5a63ef614e9cc60.png)

### 3.1.4.2 数据库-ASP后门植入连接

- 这类网站基础上都有留言功能，我们可以利用留言写入后门代码

![屏幕截图 2024 07 22 154439](https://img.picgo.net/2024/07/22/-2024-07-22-1544391e666debe2efa1ea.png)

- 上传后门，我们利用后门连接工具，就可以连接到目标服务器了

![](https://img-blog.csdnimg.cn/4571277505924ac9af0e350f1a8f8660.png)

### 3.1.4.3 中间件-IIS短文件名探针-安全漏洞

上面两个方法都需要已知数据库的路径，但是网站管理员可能会修改默认的数据库路径

- 我们需要探测网站的文件目录

![屏幕截图 2024 07 22 160427](https://img.picgo.net/2024/07/22/-2024-07-22-1604278c1410894ab88334.png)

### 3.1.4.4 中间件-IIS文件上传解析-安全漏洞

- 当我们拿到后台的账号密码，上传我们准备好的后门文件

![屏幕截图 2024 07 22 162159](https://img.picgo.net/2024/07/22/-2024-07-22-1621596b87b283e2811209.png)

- 我们再把后门改为图片格式肯定不能运行的

![屏幕截图 2024 07 22 162459](https://img.picgo.net/2024/07/22/-2024-07-22-1624591e7f4aaa89f33b16.png)

- 这个时候我们再把文件后缀改成1.jpg.asp

![](C:\Users\qiu\AppData\Roaming\marktext\images\2024-07-22-16-27-01-image.png)

### 3.1.4.5 中间件-IIS配置目录读写-安全配置

[IIS-PUT任意文件写入与短文件漏洞 - 宫小见 - 博客园 (cnblogs.com)](https://www.cnblogs.com/miyakunn/p/14383667.html)


